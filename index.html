<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shiloh Friends Church - Prayer Requests</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@400;700&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Open Sans', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
            background: linear-gradient(to bottom right, #e0f2fe, #e6e6fa); /* Light blue to light purple */
        }
        .card {
            background-color: rgba(255, 255, 255, 0.9);
            border-radius: 20px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
            padding: 40px;
            text-align: center;
            max-width: 650px; /* Slightly wider card for requests */
            width: 100%;
            display: flex;
            flex-direction: column;
            gap: 25px;
            border: 1px solid #c3b1e1;
            animation: fadeIn 0.8s ease-out;
            z-index: 2;
        }
        .brand-name {
            font-family: 'Merriweather', serif;
            font-size: 1.8rem; /* Slightly larger brand name */
            font-weight: 700;
            color: #8b5cf6;
            margin-bottom: 5px;
        }
        h1 {
            font-family: 'Merriweather', serif;
            font-size: 2.5rem; /* Larger heading */
            font-weight: 700;
            color: #6a0dad;
            margin-bottom: 20px;
        }
        .section-title {
            font-family: 'Merriweather', serif;
            font-size: 1.4rem;
            font-weight: 700;
            color: #4a0072;
            margin-top: 20px;
            margin-bottom: 15px;
        }
        .prayer-list {
            list-style: none;
            padding: 0;
            text-align: left;
            margin: 0;
        }
        .prayer-item {
            background-color: #f8f0ff; /* Lighter background for each item */
            border-radius: 10px;
            padding: 15px 20px;
            margin-bottom: 15px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            border: 1px solid #e0b0ff;
        }
        .prayer-name-date {
            font-size: 1rem;
            font-weight: 600;
            color: #6a0dad;
            margin-bottom: 5px;
        }
        .prayer-request-text {
            font-size: 1.1rem;
            color: #4a0072;
            line-height: 1.5;
        }
        .no-requests {
            font-size: 1.2rem;
            font-weight: 600;
            color: #cc4444; /* Reddish for "no requests" */
            margin-top: 20px;
        }
        .loading-spinner { /* Still useful for initial page load before content is processed */
            border: 4px solid #f3f3f3;
            border-top: 4px solid #8b5cf6;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 30px auto;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="card">
        <p class="brand-name">Shiloh Friends Church</p>
        <h1>Prayer Requests</h1>

        <div id="loading-indicator" class="loading-spinner"></div>
        <div id="prayer-content" class="hidden">
            <h2 class="section-title">Today's Prayer Requests (<span id="today-date"></span>)</h2>
            <ul id="today-prayer-list" class="prayer-list">
                <!-- Today's prayers will be loaded here -->
            </ul>
            <p id="no-today-requests" class="no-requests hidden">No prayer requests posted for today.</p>

            <h2 class="section-title">This Week's Prayer Requests</h2>
            <ul id="week-prayer-list" class="prayer-list">
                <!-- This week's prayers (if no today's) will be loaded here -->
            </ul>
            <p id="no-week-requests" class="no-requests hidden">No prayer requests posted for this week.</p>
        </div>
        <p class="footer-text">Please keep these in your prayers.</p>
    </div>

    <script>
        const loadingIndicator = document.getElementById('loading-indicator');
        const prayerContent = document.getElementById('prayer-content');
        const todayDateSpan = document.getElementById('today-date');
        const todayPrayerList = document.getElementById('today-prayer-list');
        const noTodayRequests = document.getElementById('no-today-requests');
        const weekPrayerList = document.getElementById('week-prayer-list');
        const noWeekRequests = document.getElementById('no-week-requests');

        // --- MANAGE PRAYER REQUESTS HERE ---
        // Add new prayer requests to this array.
        // Date format: 'MM/DD/YYYY' (e.g., '08/28/2025')
        // Time format: 'HH:MM AM/PM' (e.g., '09:00 AM')
        const allPrayerRequestsData = [
            // Prayer Request from Jacob Emptage (Update on Zoe) - 08/24/2025
            { Date: '08/24/2025', Time: '02:31 PM', Name: 'Jacob Emptage (for Zoe)', Request: 'For my friend Zoe who is moving out to LA. She has packed her car with all her stuff and is shipping her car out there. She is taking a flight Wednesday. Pray that her car makes it there and no issues with the flight.' },

            // Prayer Request from Becky Seaburn (Marlene's Surgery) - 08/24/2025 with Update for 08/25/2025
            { Date: '08/24/2025', Time: '06:31 PM', Name: 'Becky Seaburn (for Marlene)', Request: 'For her sister-in-law, Marlene, who is having intestinal surgery tomorrow. Pray for Surgeons & Nurses taking care of her and for a speedy recovery. (Update 08/25/2025: Surgery went well. Pray for her recovery.)' },

            // Prayer Request from Jacob Emptage (Update on Ally's dad) - 08/25/2025
            { Date: '08/25/2025', Time: '03:14 PM', Name: 'Jacob Emptage (for Ally\'s dad)', Request: 'Update on my friend Ally’s dad. He went to the hospital yesterday and they said “They didn’t find anything that they considered to be an emergency but they do see issues with his lungs”. He needs to follow up with a specialist in a few months. They gave him an inhaler till then.' },

            // Prayer Request from Jacob Emptage (for brother's dental issues) - 08/26/2025
            { Date: '08/26/2025', Time: '04:30 PM', Name: 'Jacob Emptage (for brother)', Request: 'My brother went to the dentist because he was having pain. They found that his wisdom teeth and a few molars are really bad, infected, and very crowded. He needs to get his wisdom teeth taken out. Pray that everything goes well and that he is calm.' },

            // Prayer request from Pastor Jay (For Linda's family - 08/28/2025 (TODAY)
            { Date: '08/28/2025', Time: '12:10 PM', Name: 'Pastor Jay (For Linda)', Request: 'Hospice told her to let family know Bill, Linda\'s Dad, is declining quickly and probably won\'t be long.'},

            // Add your new prayer requests below this line:
            // { Date: 'MM/DD/YYYY', Time: 'HH:MM AM/PM', Name: 'Your Name', Request: 'Your prayer request.' },
        ];
        // --- END OF PRAYER REQUESTS ---


        // Helper to format a Date object into 'MM/DD/YYYY' string for comparison and display
        function formatJsDateToMDY(dateObj) {
            const month = (dateObj.getMonth() + 1).toString().padStart(2, '0');
            const day = dateObj.getDate().toString().padStart(2, '0');
            const year = dateObj.getFullYear();
            return `${month}/${day}/${year}`;
        }

        // Helper to get Sunday of the current week (for weekly display)
        function getSundayOfCurrentWeek() {
            const today = new Date();
            const dayOfWeek = today.getDay(); // 0 for Sunday, 1 for Monday, etc.
            const diff = today.getDate() - dayOfWeek;
            return new Date(today.setDate(diff));
        }

        function displayPrayerRequests() {
            loadingIndicator.classList.add('hidden'); // Hide loading spinner immediately
            prayerContent.classList.remove('hidden'); // Show content immediately

            try {
                // Parse dates and sort requests by Date and Time
                const allRequests = allPrayerRequestsData.map(request => {
                    // Directly use MM/DD/YYYY from request.Date for parsing
                    const dateTimeString = `${request.Date} ${request.Time}`;
                    return {
                        ...request,
                        fullDateTime: new Date(dateTimeString), // For sorting and comparison
                        displayDate: request.Date // Keep original MM/DD/YYYY for display
                    };
                }).sort((a, b) => a.fullDateTime - b.fullDateTime); // Sort ascending

                const today = new Date();
                const todayString = formatJsDateToMDY(today); // Today as 'MM/DD/YYYY' string

                todayDateSpan.textContent = todayString; // Display today's date

                const requestsForToday = allRequests.filter(req => req.displayDate === todayString);

                const sundayOfThisWeek = getSundayOfCurrentWeek();
                sundayOfThisWeek.setHours(0, 0, 0, 0); // Normalize to start of day for comparison

                const endOfToday = new Date();
                endOfToday.setHours(23, 59, 59, 999); // Normalize to end of day for inclusive comparison

                // Filter for this week, excluding today
                const requestsForThisWeek = allRequests.filter(req => {
                    const reqDate = req.fullDateTime; // Use the parsed Date object for comparison
                    reqDate.setHours(0, 0, 0, 0); // Normalize to start of day for comparison

                    return reqDate >= sundayOfThisWeek && reqDate <= endOfToday;
                }).filter(req => req.displayDate !== todayString); // Exclude today's requests from this list


                // --- Display Logic for Today ---
                if (requestsForToday.length > 0) {
                    todayPrayerList.innerHTML = requestsForToday.map(req => `
                        <li class="prayer-item">
                            <p class="prayer-name-date">${req.Name} - ${req.Time}</p>
                            <p class="prayer-request-text">${req.Request}</p>
                        </li>
                    `).join('');
                    noTodayRequests.classList.add('hidden'); // Hide "No requests" message
                } else {
                    todayPrayerList.innerHTML = ''; // Clear list
                    noTodayRequests.classList.remove('hidden'); // Show "No requests" message
                }

                // --- Display Logic for This Week ---
                if (requestsForThisWeek.length > 0) {
                    weekPrayerList.innerHTML = requestsForThisWeek.map(req => `
                        <li class="prayer-item">
                            <p class="prayer-name-date">${req.Name} - ${req.displayDate} ${req.Time}</p>
                            <p class="prayer-request-text">${req.Request}</p>
                        </li>
                    `).join('');
                    noWeekRequests.classList.add('hidden'); // Hide "No requests" message
                } else {
                    weekPrayerList.innerHTML = ''; // Clear list
                    noWeekRequests.classList.remove('hidden'); // Show "No requests" message
                }

            } catch (error) {
                console.error("Error displaying prayer requests:", error);
                todayPrayerList.innerHTML = `<li class="no-requests text-center">There was an error loading prayer requests. Please check the data format.</li>`;
                noTodayRequests.classList.remove('hidden');
                weekPrayerList.innerHTML = ''; // Clear list
                noWeekRequests.classList.remove('hidden');
            } finally {
                // Initial loading spinner is always hidden
            }
        }

        // Display requests when the page loads
        displayPrayerRequests();
    </script>
</body>
</html>
